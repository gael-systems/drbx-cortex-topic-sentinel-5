<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>

<!DOCTYPE rdf:RDF [
   <!ENTITY rdf "http://www.w3.org/1999/02/22-rdf-syntax-ns#">
   <!ENTITY rdfs "http://www.w3.org/2000/01/rdf-schema#">
   <!ENTITY owl "http://www.w3.org/2002/07/owl#">
   <!ENTITY nc "http://www.unidata.ucar.edu/netcdf#">
   <!ENTITY s5p "http://www.esa.int/s5p#">
   <!ENTITY drb "http://www.gael.fr/drb#">
   <!ENTITY img "http://www.gael.fr/drb/image#">
]>

<rdf:RDF xmlns:owl="&owl;"
         xmlns:rdf="&rdf;"
         xmlns:rdfs="&rdfs;"
         xmlns:drb="&drb;"
         xmlns:nc="&nc;"
         xmlns:img="&img;"
         xmlns:s5p="&s5p;"
         xml:base="&s5p;">

<!--
* Data Hub Service (DHuS) - For Space data distribution.
* Copyright (C) 2017 GAEL Systems
* Copyright (C) 2017 ESA
*
* This file is part of DHuS software sources.
*
* This program is free software: you can redistribute it and/or modify
* it under the terms of the GNU Affero General Public License as
* published by the Free Software Foundation, either version 3 of the
* License, or (at your option) any later version.
*
* This program is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
* GNU Affero General Public License for more details.
*
* You should have received a copy of the GNU Affero General Public License
* along with this program. If not, see <http://www.gnu.org/licenses/>.
-->

   <owl:Ontology rdf:about="&s5p;">
      <rdfs:label xml:lang="en">Sentinel-5P Ontology</rdfs:label>
   </owl:Ontology>

   <!-- ========================================= -->
   <!-- ========================================= -->
   <!-- Sentinel-5P Base class                    -->
   <!-- ========================================= -->
   <!-- ========================================= -->

   <owl:Class rdf:about="&s5p;baseClass">
      <rdfs:label xml:lang="en">Sentinel-5P Base Class</rdfs:label>
      <rdfs:comment xml:lang="en">
         Base class for Sentinel 5P. This class includes all S5P products and
         auxiliary products (with exception of NISE auxiliary products).
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&nc;netCDF"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._(AUX|L).*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ========================================= -->
   <!-- ========================================= -->
   <!-- Sentinel-5P Product                       -->
   <!-- ========================================= -->
   <!-- ========================================= -->

   <owl:Class rdf:about="&s5p;product">
      <rdfs:label xml:lang="en">Sentinel-5P Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;baseClass"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L.*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ========================================= -->
   <!-- ========================================= -->
   <!-- Sentinel-5P Level-1B Product              -->
   <!-- ========================================= -->
   <!-- ========================================= -->

   <owl:Class rdf:about="&s5p;productLevel1B">
      <rdfs:label xml:lang="en">Sentinel-5P Level-1B Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;product"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L1B.*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Level-1B: Irradiances UVN Product                 -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;productLevel1BIrUvn">
      <rdfs:label xml:lang="en">Sentinel-5P Level-1B: Irradiances UVN Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;productLevel1B"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L1B_IR_UVN.*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Level-1B: Irradiances SIR Product                 -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;productLevel1BIrSir">
      <rdfs:label xml:lang="en">Sentinel-5P Level-1B: Irradiances SIR Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;productLevel1B"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L1B_IR_SIR.*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Level-1B: Radiances Product                       -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;productLevel1BRa">
      <rdfs:label xml:lang="en">Sentinel-5P Level-1B: Radiances Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;productLevel1B"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L1B_RA_BD[1-8].*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Level-1B: Radiances BD1 Product                   -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;productLevel1BRaBd1">
      <rdfs:label xml:lang="en">Sentinel-5P Level-1B: Radiances BD1 Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;productLevel1B"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L1B_RA_BD1.*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Level-1B: Radiances BD2 Product                   -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;productLevel1BRaBd2">
      <rdfs:label xml:lang="en">Sentinel-5P Level-1B: Radiances BD2 Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;productLevel1B"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L1B_RA_BD2.*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Level-1B: Radiances BD3 Product                   -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;productLevel1BRaBd3">
      <rdfs:label xml:lang="en">Sentinel-5P Level-1B: Radiances BD3 Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;productLevel1B"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L1B_RA_BD3.*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Level-1B: Radiances BD4 Product                   -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;productLevel1BRaBd4">
      <rdfs:label xml:lang="en">Sentinel-5P Level-1B: Radiances BD4 Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;productLevel1B"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L1B_RA_BD4.*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Level-1B: Radiances BD5 Product                   -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;productLevel1BRaBd5">
      <rdfs:label xml:lang="en">Sentinel-5P Level-1B: Radiances BD5 Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;productLevel1B"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L1B_RA_BD5.*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Level-1B: Radiances BD6 Product                   -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;productLevel1BRaBd6">
      <rdfs:label xml:lang="en">Sentinel-5P Level-1B: Radiances BD6 Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;productLevel1B"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L1B_RA_BD6.*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Level-1B: Radiances BD7 Product                   -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;productLevel1BRaBd7">
      <rdfs:label xml:lang="en">Sentinel-5P Level-1B: Radiances BD7 Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;productLevel1B"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L1B_RA_BD7.*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Level-1B: Radiances BD8 Product                   -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;productLevel1BRaBd8">
      <rdfs:label xml:lang="en">Sentinel-5P Level-1B: Radiances BD8 Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;productLevel1B"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L1B_RA_BD8.*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ========================================= -->
   <!-- ========================================= -->
   <!-- Sentinel-5P Level-2 Product               -->
   <!-- ========================================= -->
   <!-- ========================================= -->

   <owl:Class rdf:about="&s5p;productLevel2">
      <rdfs:label xml:lang="en">Sentinel-5P Level-2 Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;product"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L2.*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Level-2: O3 Full Profile Product                  -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;productLevel2O3Pr">
      <rdfs:label xml:lang="en">Sentinel-5P Level-2: O3 Full Profile Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;productLevel2"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L2__O3__PR.*</drb:nameMatch>
      </drb:signature>
      <!-- Image descriptor -->  
      <img:descriptor rdf:parseType="Literal">
         <raster name="o3profile">
            <width>
               root/groups/PRODUCT/variables/ozone_total_column/shape[3]
            </width>
            <height>
               root/groups/PRODUCT/variables/ozone_total_column/shape[2]
            </height>
            <bandNumber>
               root/groups/PRODUCT/variables/ozone_total_column/shape[1]
            </bandNumber>
            <data sampleModel="banded" type="float">
               fn:data(root/groups/PRODUCT/dataset/ozone_total_column/time/scanline/ground_pixel)               
            </data>
          </raster>
      </img:descriptor>
      <img:rendering rdf:parseType="Literal">
         <img:operator name="float-image" xmlns:img="&img;">
            <img:script>
               import fr.gael.drb.cortex.topic.sentinel5p.ScaleFloatToByte;
               
               double nodata = ScaleFloatToByte.extract(source,
                  "fn:data(root/groups/PRODUCT/variables/ozone_total_column/attributes/_FillValue)");
               double offset = 0.0; // no offset defined in dataset
      
               // Scale used is the factor value used to convert to DU (mol.m-2)
               double scale = ScaleFloatToByte.extract(source,
                  "fn:data(root/groups/PRODUCT/variables/ozone_total_column/attributes/multiplication_factor_to_convert_to_DU)");
               
               return ScaleFloatToByte.scaleFloatToByte (source, nodata, scale, offset);
            </img:script>
         </img:operator>
      </img:rendering>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Level-2: O3 Tropospheric Profile Product          -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;productLevel2O3Tpr">
      <rdfs:label xml:lang="en">Sentinel-5P Level-2: O3 Tropospheric Profile Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;productLevel2"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L2__O3_TPR.*</drb:nameMatch>
      </drb:signature>
      <!-- Image descriptor -->  
      <img:descriptor rdf:parseType="Literal">
         <raster name="o3tclprofile">
            <width>
               root/groups/PRODUCT/variables/ozone_tropospheric_column/shape[3]
            </width>
            <height>
               root/groups/PRODUCT/variables/ozone_tropospheric_column/shape[2]
            </height>
            <bandNumber>
               root/groups/PRODUCT/variables/ozone_tropospheric_column/shape[1]
            </bandNumber>
            <data sampleModel="banded" type="float">
               fn:data(root/groups/PRODUCT/dataset/ozone_tropospheric_column/time/scanline/ground_pixel)               
            </data>
          </raster>
      </img:descriptor>
      <img:rendering rdf:parseType="Literal">
         <img:operator name="float-image" xmlns:img="&img;">
            <img:script>
               import fr.gael.drb.cortex.topic.sentinel5p.ScaleFloatToByte;
               
               double nodata = ScaleFloatToByte.extract(source,
                  "fn:data(root/groups/PRODUCT/variables/ozone_tropospheric_column/attributes/_FillValue)");
               double offset = 0.0; // no offset defined in dataset
      
               // Scale used is the factor value used to convert to DU (mol.m-2)
               double scale = ScaleFloatToByte.extract(source,
                  "fn:data(root/groups/PRODUCT/variables/ozone_tropospheric_column/attributes/multiplication_factor_to_convert_to_DU)");
               
               return ScaleFloatToByte.scaleFloatToByte (source, nodata, scale, offset);
            </img:script>
         </img:operator>
      </img:rendering>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Level-2: NO2 Tropospheric Column Product          -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;productLevel2NO2">
      <rdfs:label xml:lang="en">Sentinel-5P Level-2: NO2 Tropospheric Column Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;productLevel2"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L2__NO2___.*</drb:nameMatch>
      </drb:signature>
      <!-- Image descriptor -->  
      <img:descriptor rdf:parseType="Literal">
         <raster name="no2">
            <width>
               root/groups/PRODUCT/variables/nitrogendioxide_tropospheric_column/shape[3]
            </width>
            <height>
               root/groups/PRODUCT/variables/nitrogendioxide_tropospheric_column/shape[2]
            </height>
            <bandNumber>
               root/groups/PRODUCT/variables/nitrogendioxide_tropospheric_column/shape[1]
            </bandNumber>
            <data sampleModel="banded" type="'Float'">
               fn:data(root/groups/PRODUCT/dataset/nitrogendioxide_tropospheric_column/time/scanline/ground_pixel)               
            </data>
          </raster>
      </img:descriptor>
      <img:rendering rdf:parseType="Literal">
         <img:operator name="float-image" xmlns:img="&img;">
            <img:script>
               import fr.gael.drb.cortex.topic.sentinel5p.ScaleFloatToByte;
               
               double nodata = ScaleFloatToByte.extract(source,
                  "fn:data(root/groups/PRODUCT/variables/nitrogendioxide_tropospheric_column/attributes/_FillValue)");
               double offset = 0.0; // no offset defined in dataset
               // Scale used is the factor value used to convert to DU (mol.m-2)
               double scale = 1.0;
               
               return ScaleFloatToByte.scaleFloatToByte (source, nodata, scale, offset);
            </img:script>
         </img:operator>
      </img:rendering>
      
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Level-2: CH4 Product                              -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;productLevel2CH4">
      <rdfs:label xml:lang="en">Sentinel-5P Level-2: CH4 Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;productLevel2"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L2__CH4___.*</drb:nameMatch>
      </drb:signature>
      <!-- Image descriptor -->  
      <img:descriptor rdf:parseType="Literal">
         <raster name="ch4">
            <width>
               root/groups/PRODUCT/variables/methane_mixing_ratio/shape[3]
            </width>
            <height>
               root/groups/PRODUCT/variables/methane_mixing_ratio/shape[2]
            </height>
            <bandNumber>
               root/groups/PRODUCT/variables/methane_mixing_ratio/shape[1]
            </bandNumber>
            <data sampleModel="banded" type="'Float'">
               fn:data(root/groups/PRODUCT/dataset/methane_mixing_ratio/time/scanline/ground_pixel)               
            </data>
          </raster>
      </img:descriptor>
      <img:rendering rdf:parseType="Literal">
         <img:operator name="float-image" xmlns:img="&img;">
            <img:script>
               import fr.gael.drb.cortex.topic.sentinel5p.ScaleFloatToByte;
               
               double nodata = ScaleFloatToByte.extract(source,
                  "fn:data(root/groups/PRODUCT/variables/methane_mixing_ratio/attributes/_FillValue)");
               double offset = 0.0; // no offset defined in dataset
      
               // Scale used is the factor value used to convert to DU (mol.m-2)
               double scale = 1.0;
               
               return ScaleFloatToByte.scaleFloatToByte (source, nodata, scale, offset);
            </img:script>
         </img:operator>
      </img:rendering>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Level-2: CO Total Column Product                  -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;productLevel2CO">
      <rdfs:label xml:lang="en">Sentinel-5P Level-2: CO Total Column Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;productLevel2"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L2__CO____.*</drb:nameMatch>
      </drb:signature>
      <!-- Image descriptor -->  
      <img:descriptor rdf:parseType="Literal">
         <raster name="co">
            <width>
               root/groups/PRODUCT/variables/carbonmonoxide_total_column/shape[3]
            </width>
            <height>
               root/groups/PRODUCT/variables/carbonmonoxide_total_column/shape[2]
            </height>
            <bandNumber>
               root/groups/PRODUCT/variables/carbonmonoxide_total_column/shape[1]
            </bandNumber>
            <data sampleModel="banded" type="'Float'">
               fn:data(root/groups/PRODUCT/dataset/carbonmonoxide_total_column/time/scanline/ground_pixel)               
            </data>
          </raster>
      </img:descriptor>
      <img:rendering rdf:parseType="Literal">
         <img:operator name="float-image" xmlns:img="&img;">
            <img:script>
               import fr.gael.drb.cortex.topic.sentinel5p.ScaleFloatToByte;
               
               double nodata = ScaleFloatToByte.extract(source,
                  "fn:data(root/groups/PRODUCT/variables/carbonmonoxide_total_column/attributes/_FillValue)");
               double offset = 0.0; // no offset defined in dataset
      
               // Scale used is the factor value used to convert to DU (mol.m-2)
               double scale = 1.0;
               
               return ScaleFloatToByte.scaleFloatToByte (source, nodata, scale, offset);
            </img:script>
         </img:operator>
      </img:rendering>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Level-2: Aerosol Layer Height Product             -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;productLevel2AerLH">
      <rdfs:label xml:lang="en">Sentinel-5P Level-2: Aerosol Layer Height Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;productLevel2"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L2__AER_LH.*</drb:nameMatch>
      </drb:signature>
      <!-- Image descriptor -->  
      <img:descriptor rdf:parseType="Literal">
         <raster name="aerlh">
            <width>
               root/groups/PRODUCT/variables/aerosol_mid_height/shape[3]
            </width>
            <height>
               root/groups/PRODUCT/variables/aerosol_mid_height/shape[2]
            </height>
            <bandNumber>
               root/groups/PRODUCT/variables/aerosol_mid_height/shape[1]
            </bandNumber>
            <data sampleModel="banded" type="'Float'">
               fn:data(root/groups/PRODUCT/dataset/aerosol_mid_height/time/scanline/ground_pixel)               
            </data>
          </raster>
      </img:descriptor>
      <img:rendering rdf:parseType="Literal">
         <img:operator name="float-image" xmlns:img="&img;">
            <img:script>
               import fr.gael.drb.cortex.topic.sentinel5p.ScaleFloatToByte;
               
               double nodata = ScaleFloatToByte.extract(source,
                  "fn:data(root/groups/PRODUCT/variables/aerosol_mid_height/attributes/_FillValue)");
               double offset = 0.0; // no offset defined in dataset
      
               // Scale used is the factor value used to convert to DU (mol.m-2)
               double scale = 1.0;
               
               return ScaleFloatToByte.scaleFloatToByte (source, nodata, scale, offset);
            </img:script>
         </img:operator>
      </img:rendering>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Level-2: Aerosol Index Product                    -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;productLevel2AerAI">
      <rdfs:label xml:lang="en">Sentinel-5P Level-2: Aerosol Index Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;productLevel2"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L2__AER_AI.*</drb:nameMatch>
      </drb:signature>
      <!-- Image descriptor -->  
      <img:descriptor rdf:parseType="Literal">
         <raster name="aerai">
            <width>
               root/groups/PRODUCT/variables/aerosol_index_340_380/shape[3]
            </width>
            <height>
               root/groups/PRODUCT/variables/aerosol_index_340_380/shape[2]
            </height>
            <bandNumber>
               root/groups/PRODUCT/variables/aerosol_index_340_380/shape[1]
            </bandNumber>
            <data sampleModel="banded" type="'Float'">
               fn:data(root/groups/PRODUCT/dataset/aerosol_index_340_380/time/scanline/ground_pixel)               
            </data>
          </raster>
      </img:descriptor>
      <img:rendering rdf:parseType="Literal">
         <img:operator name="float-image" xmlns:img="&img;">
            <img:script>
               import fr.gael.drb.cortex.topic.sentinel5p.ScaleFloatToByte;
               
               double nodata = ScaleFloatToByte.extract(source,
                  "fn:data(root/groups/PRODUCT/variables/aerosol_index_340_380/attributes/_FillValue)");
               double offset = 0.0; // no offset defined in dataset
      
               // Scale used is the factor value used to convert to DU (mol.m-2)
               double scale = 1.0;
               
               return ScaleFloatToByte.scaleFloatToByte (source, nodata, scale, offset);
            </img:script>
         </img:operator>
      </img:rendering>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Level-2: KNMI Cloud Support Product               -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;productLevel2Fresco">
      <rdfs:label xml:lang="en">Sentinel-5P Level-2: KNMI Cloud Support Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;productLevel2"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L2__FRESCO.*</drb:nameMatch>
      </drb:signature>
      <!-- Image descriptor -->  
      <img:descriptor rdf:parseType="Literal">
         <raster name="fresco">
            <width>
               root/groups/PRODUCT/variables/cloud_fraction_crb/shape[3]
            </width>
            <height>
               root/groups/PRODUCT/variables/cloud_fraction_crb/shape[2]
            </height>
            <bandNumber>
               root/groups/PRODUCT/variables/cloud_fraction_crb/shape[1]
            </bandNumber>
            <data sampleModel="banded" type="'Float'">
               fn:data(root/groups/PRODUCT/dataset/cloud_fraction_crb/time/scanline/ground_pixel)               
            </data>
          </raster>
      </img:descriptor>
      <img:rendering rdf:parseType="Literal">
         <img:operator name="float-image" xmlns:img="&img;">
            <img:script>
               import fr.gael.drb.cortex.topic.sentinel5p.ScaleFloatToByte;
               
               double nodata = ScaleFloatToByte.extract(source,
                  "fn:data(root/groups/PRODUCT/variables/cloud_fraction_crb/attributes/_FillValue)");
               double offset = 0.0; // no offset defined in dataset
      
               // Scale used is the factor value used to convert to DU (mol.m-2)
               double scale = 1.0;
               
               return ScaleFloatToByte.scaleFloatToByte (source, nodata, scale, offset);
            </img:script>
         </img:operator>
      </img:rendering>      
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Level-2: Cloud Product                            -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;productLevel2Cloud">
      <rdfs:label xml:lang="en">Sentinel-5P Level-2: Cloud Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;productLevel2"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L2__CLOUD_.*</drb:nameMatch>
      </drb:signature>
      
      <!-- Image descriptor -->  
      <img:descriptor rdf:parseType="Literal">
         <raster name="cloud">
            <width>
               root/groups/PRODUCT/variables/cloud_fraction/shape[3]
            </width>
            <height>
               root/groups/PRODUCT/variables/cloud_fraction/shape[2]
            </height>
            <bandNumber>
               root/groups/PRODUCT/variables/cloud_fraction/shape[1]
            </bandNumber>
            <data sampleModel="banded" type="'Float'">
               fn:data(root/groups/PRODUCT/dataset/cloud_fraction/time/scanline/ground_pixel)               
            </data>
          </raster>
      </img:descriptor>
      <img:rendering rdf:parseType="Literal">
         <img:operator name="float-image" xmlns:img="&img;">
            <img:script>
               import fr.gael.drb.cortex.topic.sentinel5p.ScaleFloatToByte;
               
               double nodata = ScaleFloatToByte.extract(source,
                  "fn:data(root/groups/PRODUCT/variables/cloud_fraction/attributes/_FillValue)");
               double offset = 0.0; // no offset defined in dataset
      
               // Scale used is the factor value used to convert to DU (mol.m-2)
               double scale = 1.0;
               
               return ScaleFloatToByte.scaleFloatToByte (source, nodata, scale, offset);
            </img:script>
         </img:operator>
      </img:rendering>      
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Level-2: Formaldehyde Product                     -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;productLevel2HCHO">
      <rdfs:label xml:lang="en">Sentinel-5P Level-2: Formaldehyde Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;productLevel2"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L2__HCHO__.*</drb:nameMatch>
      </drb:signature>
      <!-- Image descriptor -->  
      <img:descriptor rdf:parseType="Literal">
         <raster name="hcho">
            <width>
               root/groups/PRODUCT/variables/formaldehyde_tropospheric_vertical_column/shape[3]
            </width>
            <height>
               root/groups/PRODUCT/variables/formaldehyde_tropospheric_vertical_column/shape[2]
            </height>
            <bandNumber>
               root/groups/PRODUCT/variables/formaldehyde_tropospheric_vertical_column/shape[1]
            </bandNumber>
            <data sampleModel="banded" type="'Float'">
               fn:data(root/groups/PRODUCT/dataset/formaldehyde_tropospheric_vertical_column/time/scanline/ground_pixel)               
            </data>
          </raster>
      </img:descriptor>
      <img:rendering rdf:parseType="Literal">
         <img:operator name="float-image" xmlns:img="&img;">
            <img:script>
               import fr.gael.drb.cortex.topic.sentinel5p.ScaleFloatToByte;
               
               double nodata = ScaleFloatToByte.extract(source,
                  "fn:data(root/groups/PRODUCT/variables/formaldehyde_tropospheric_vertical_column/attributes/_FillValue)");
               double offset = 0.0; // no offset defined in dataset
      
               // Scale used is the factor value used to convert to DU (mol.m-2)
               double scale = ScaleFloatToByte.extract(source,
                  "fn:data(root/groups/PRODUCT/variables/formaldehyde_tropospheric_vertical_column/attributes/multiplication_factor_to_convert_to_DU)");
               
               
               return ScaleFloatToByte.scaleFloatToByte (source, nodata, scale, offset);
            </img:script>
         </img:operator>
      </img:rendering>      
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Level-2: Sulphur Dioxide Product                  -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;productLevel2SO2">
      <rdfs:label xml:lang="en">Sentinel-5P Level-2: Sulphur Dioxide Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;productLevel2"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L2__SO2___.*</drb:nameMatch>
      </drb:signature>
      <!-- Image descriptor -->  
      <img:descriptor rdf:parseType="Literal">
         <raster name="so2">
            <width>
               root/groups/PRODUCT/variables/sulfurdioxide_total_vertical_column/shape[3]
            </width>
            <height>
               root/groups/PRODUCT/variables/sulfurdioxide_total_vertical_column/shape[2]
            </height>
            <bandNumber>
               root/groups/PRODUCT/variables/sulfurdioxide_total_vertical_column/shape[1]
            </bandNumber>
            <data sampleModel="banded" type="'Float'">
               fn:data(root/groups/PRODUCT/dataset/sulfurdioxide_total_vertical_column/time/scanline/ground_pixel)               
            </data>
          </raster>
      </img:descriptor>
      <img:rendering rdf:parseType="Literal">
         <img:operator name="float-image" xmlns:img="&img;">
            <img:script>
               import fr.gael.drb.cortex.topic.sentinel5p.ScaleFloatToByte;
               
               double nodata = ScaleFloatToByte.extract(source,
                  "fn:data(root/groups/PRODUCT/variables/sulfurdioxide_total_vertical_column/attributes/_FillValue)");
               double offset = 0.0; // no offset defined in dataset
      
               // Scale used is the factor value used to convert to DU (mol.m-2)
               double scale = ScaleFloatToByte.extract(source,
                  "fn:data(root/groups/PRODUCT/variables/sulfurdioxide_total_vertical_column/attributes/multiplication_factor_to_convert_to_DU)");
               
               
               return ScaleFloatToByte.scaleFloatToByte (source, nodata, scale, offset);
            </img:script>
         </img:operator>
      </img:rendering>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Level-2: Ozone Total Column Product               -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;productLevel2O3">
      <rdfs:label xml:lang="en">Sentinel-5P Level-2: Ozone Total Column Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;productLevel2"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L2__O3____.*</drb:nameMatch>
      </drb:signature>
      <!-- Image descriptor -->  
      <img:descriptor rdf:parseType="Literal">
         <raster name="o3">
            <width>
               root/groups/PRODUCT/variables/ozone_total_vertical_column/shape[3]
            </width>
            <height>
               root/groups/PRODUCT/variables/ozone_total_vertical_column/shape[2]
            </height>
            <bandNumber>
               root/groups/PRODUCT/variables/ozone_total_vertical_column/shape[1]
            </bandNumber>
            <data sampleModel="banded" type="'Float'">
               fn:data(root/groups/PRODUCT/dataset/ozone_total_vertical_column/time/scanline/ground_pixel)               
            </data>
          </raster>
      </img:descriptor>
      <img:rendering rdf:parseType="Literal">
         <img:operator name="float-image" xmlns:img="&img;">
            <img:script>
               import fr.gael.drb.cortex.topic.sentinel5p.ScaleFloatToByte;
               
               double nodata = ScaleFloatToByte.extract(source,
                  "fn:data(root/groups/PRODUCT/variables/ozone_total_vertical_column/attributes/_FillValue)");
               double offset = 0.0; // no offset defined in dataset
      
               // Scale used is the factor value used to convert to DU (mol.m-2)
               double scale = ScaleFloatToByte.extract(source,
                  "fn:data(root/groups/PRODUCT/variables/ozone_total_vertical_column/attributes/multiplication_factor_to_convert_to_DU)");
               
               return ScaleFloatToByte.scaleFloatToByte (source, nodata, scale, offset);
            </img:script>
         </img:operator>
      </img:rendering>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Level-2: Ozone Tropospheric Column Product        -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;productLevel2O3TCL">
      <rdfs:label xml:lang="en">Sentinel-5P Level-2: Ozone Tropospheric Column Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;productLevel2"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._L2__O3_TCL.*</drb:nameMatch>
      </drb:signature>
      <!-- Image descriptor -->  
      <img:descriptor rdf:parseType="Literal">
         <raster name="o3tcl">
            <width>
               root/groups/PRODUCT/variables/ozone_tropospheric_vertical_column/shape[3]
            </width>
            <height>
               root/groups/PRODUCT/variables/ozone_tropospheric_vertical_column/shape[2]
            </height>
            <bandNumber>
               root/groups/PRODUCT/variables/ozone_tropospheric_vertical_column/shape[1]
            </bandNumber>
            <data sampleModel="banded" type="'Float'">
               fn:data(root/groups/PRODUCT/dataset/ozone_tropospheric_vertical_column/time/latitude_ccd/longitude_ccd)
            </data>
          </raster>
      </img:descriptor>
      <img:rendering rdf:parseType="Literal">
         <img:operator name="float-image" xmlns:img="&img;">
            <img:script>
               import fr.gael.drb.cortex.topic.sentinel5p.ScaleFloatToByte;
               
               double nodata = ScaleFloatToByte.extract(source,
                  "fn:data(root/groups/PRODUCT/variables/ozone_tropospheric_vertical_column/attributes/_FillValue)");
               double offset = 0.0; // no offset defined in dataset
      
               // Scale used is the factor value used to convert to DU (mol.m-2)
               double scale = ScaleFloatToByte.extract(source,
                  "fn:data(root/groups/PRODUCT/variables/ozone_tropospheric_vertical_column/attributes/multiplication_factor_to_convert_to_DU)");
               
               return ScaleFloatToByte.scaleFloatToByte (source, nodata, scale, offset);
            </img:script>
         </img:operator>
      </img:rendering>
   </owl:Class>

   <!-- ========================================= -->
   <!-- ========================================= -->
   <!-- Sentinel-5P Auxiliary Product             -->
   <!-- ========================================= -->
   <!-- ========================================= -->

   <owl:Class rdf:about="&s5p;auxiliary">
      <rdfs:label xml:lang="en">Sentinel-5P Auxiliary Product</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;baseClass"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._AUX.*</drb:nameMatch>
      </drb:signature>

   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Auxiliary: NISE snow and ice                      -->
   <!-- ============================================================= -->
   <!-- Attention:                                                    -->
   <!-- This product is not subClassOf Sentinel-5P Auxiliary Product  -->
   <!-- since it is not a &nc;netCDF and signature does not follow    -->
   <!-- "(?i)S5P_...._AUX.*"                                          -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;auxiliaryNise">
      <rdfs:label xml:lang="en">Sentinel-5P Auxiliary Product: NISE snow and ice</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&nc;HDFEOS"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)NISE_........_........\.HDFEOS</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Auxiliary: Meteo files (abstract)                 -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;auxiliaryMeteo">
      <rdfs:label xml:lang="en">Sentinel-5P Auxiliary Product: Meteo (Abstract)</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;auxiliary"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._AUX_MET_.*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Auxiliary: ECMWF temperature profiles             -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;auxiliaryMetTp">
      <rdfs:label xml:lang="en">Sentinel-5P Auxiliary Product: ECMWF temperature profiles</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;auxiliaryMeteo"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._AUX_MET_TP.*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Auxiliary: ECMWF specific humidity profiles       -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;auxiliaryMetQp">
      <rdfs:label xml:lang="en">Sentinel-5P Auxiliary Product: ECMWF specific humidity profiles</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;auxiliaryMeteo"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._AUX_MET_QP.*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Auxiliary: ECMWF 2D surface fields                -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;auxiliaryMet2D">
      <rdfs:label xml:lang="en">Sentinel-5P Auxiliary Product: ECMWF 2D surface fields</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;auxiliaryMeteo"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._AUX_MET_2D.*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Auxiliary: NO2 profile data (forecast mode)       -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;auxiliaryNO2Forecast">
      <rdfs:label xml:lang="en">Sentinel-5P Auxiliary Product: NO2 profile data (forecast mode)</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;auxiliary"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._AUX_CTMFCT.*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Auxiliary: NO2 profile data (assimilation mode)   -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;auxiliaryNO2Assimilation">
      <rdfs:label xml:lang="en">Sentinel-5P Auxiliary Product: NO2 profile data (assimilation mode)</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;auxiliary"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._AUX_CTMANA.*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Auxiliary: CO a priori profiles                   -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;auxiliaryCO">
      <rdfs:label xml:lang="en">Sentinel-5P Auxiliary Product: CO a priori profiles</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;auxiliary"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._AUX_CTM_CO.*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Auxiliary: CH4 a priori profiles                  -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;auxiliaryCH4">
      <rdfs:label xml:lang="en">Sentinel-5P Auxiliary Product: CH4 a priori profiles</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;auxiliary"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._AUX_CTMCH4.*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Auxiliary: BGSO2 Background Correction            -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;auxiliaryBGSO2">
      <rdfs:label xml:lang="en">Sentinel-5P Auxiliary Product: BGSO2 Background Correction</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;auxiliary"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._AUX_BGSO2_.*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- ============================================================= -->
   <!-- Sentinel-5P Auxiliary: BGHCHO Background Correction           -->
   <!-- ============================================================= -->

   <owl:Class rdf:about="&s5p;auxiliaryBGHCHO">
      <rdfs:label xml:lang="en">Sentinel-5P Auxiliary Product: BGHCHO Background Correction</rdfs:label>
      <rdfs:comment xml:lang="en">
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s5p;auxiliary"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>(?i)S5P_...._AUX_BGHCHO.*</drb:nameMatch>
      </drb:signature>
   </owl:Class>

</rdf:RDF>
